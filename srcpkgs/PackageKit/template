# Template file for 'PackageKit'
pkgname=PackageKit
version=1.2.6
revision=1
build_style=meson
build_helper="gir"
configure_args="-Dgstreamer_plugin=false -Dgtk_module=false
 -Dsystemd=false -Dgobject_introspection=$(vopt_if gir true false)
 -Doffline_update=false -Dbash_command_not_found=false -Dlocal_checkout=true"
hostmakedepends="glib-devel gettext-devel polkit-devel docbook-xsl
 $(vopt_if vala 'vala-devel') libxslt-devel pkg-config which"
makedepends="bash-completion gettext-devel glib-devel polkit-devel
 sqlite-devel $(vopt_if vala 'vala-devel') libxslt-devel"
short_desc="D-BUS abstraction layer to package management API"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-2.0-or-later"
homepage="https://github.com/hughsie/PackageKit"
distfiles="https://github.com/hughsie/PackageKit/archive/v${version}.tar.gz"
checksum=adf7624620bb45ee3499c03b3a4ec0d7001ec919c6f22a5b9bf43636c66f1819
conf_files="/etc/PackageKit/PackageKit.conf /etc/PackageKit/PackageKit.conf"

build_options="gir vala"
build_options_default="gir vala"

do_check() {
  true
}

post_install() {
	vsv packagekitd
}

PackageKit-devel_package() {
	depends="PackageKit-${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
		if [ "$build_option_gir" ]; then
			vmove usr/share/gir-1.0
		fi
		if [ "$build_option_vala" ]; then
			vmove usr/share/vala
		fi
	}
}
